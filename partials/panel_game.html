<div class="tabs-panel" id="panel_game">
    <div class="game-container">
        <!-- Top Section: Board/Controls + Sidebar -->
        <div class="game-top-section">
            <div class="game-layout-main">

            <!-- NEW: Card Table Area (Encircling Layout) -->
            <div class="game-panel game-table-panel hidden" id="game-table-panel" style="background: none; border: none; box-shadow: none; padding: 0;">
                <div class="table-layout-grid">
                    <!-- Left Side (Upstream) -->
                    <div class="table-side-col left-col">
                        <div id="role-list-left" class="role-column"></div>
                    </div>

                    <!-- Center (Top Opponents + Treatment Area) -->
                    <div class="table-center-col">
                        <!-- Top Row Opponents -->
                        <div id="role-list-top" class="role-row"></div>
                        
                        <!-- Treatment Area (Center) & Piles -->
                        <div class="game-panel game-board-panel hidden" id="game-board-panel" style="margin-top: 15px; width: 100%;">
                            <div class="board-area-row" style="display: flex; gap: 15px; align-items: flex-start; justify-content: center; min-height: 140px;">
                                
                                <!-- Draw Pile (Left) -->
                                <div class="board-pile-slot" style="flex: 0 0 100px; width: 100px; display: flex; flex-direction: column; justify-content: center; position: relative; z-index: 5;">
                                    <div id="header-pile" class="area-watermark"></div>
                                    <div id="pile-container" class="cards-container pile-container deck-slot" data-area-name="pile" style="flex: 1; position: relative;">
                                        <!-- Cards here -->
                                    </div>
                                </div>

                                <!-- Treatment Area (Center) -->
                                <div class="treatment-area-wrappper" style="flex: 0.8; position: relative; min-width: 0; display: flex; flex-direction: column; z-index: 1;">
                                    <div id="header-treatment-area" class="area-watermark"></div>
                                    <div id="treatment-area-container" class="cards-container treatment-container" data-area-name="treatmentArea" style="flex: 1;">
                                        <!-- Cards will be rendered here -->
                                    </div>
                                </div>

                                <!-- Discard Pile (Right) -->
                                <div class="board-pile-slot" style="flex: 0 0 100px; width: 100px; display: flex; flex-direction: column; justify-content: center; position: relative; z-index: 5;">
                                    <div id="header-discard-pile" class="area-watermark"></div>
                                    <div id="discard-pile-container" class="cards-container pile-container deck-slot" data-area-name="discardPile" style="flex: 1; position: relative;">
                                        <!-- Cards here -->
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- Right Side (Downstream) -->
                    <div class="table-side-col right-col">
                        <div id="role-list-right" class="role-column"></div>
                    </div>
                </div>
            </div>

            <!-- Setup Panel (kept separate or overlay) -->
        <div id="game-setup-ui" class="game-panel hidden" style="border: 1px solid #444; padding: 15px; margin-bottom: 20px; background: rgba(0,0,0,0.5);">
            <div class="row">
                 <div class="input-group">
                    <span class="input-group-label" data-i18n="game.setup.playerCount">Role Count</span>
                    <select id="setup-player-count-select" class="input-group-field" style="width: auto;">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="8">8</option>
                    </select>
                 </div>
                 <div class="input-group" style="margin-left: 20px;">
                    <span class="input-group-label" data-i18n="game.setup.cardPreset">Card Preset</span>
                    <select id="setup-card-preset-select" class="input-group-field" style="width: auto;">
                        <option value="standard">Standard</option>
                        <option value="80sha80shan">80 Sha 80 Shan</option>
                    </select>
                 </div>
                 
                 <!-- NEW: Mode Selection -->
                 <div class="input-group" style="margin-left: 20px;">
                    <span class="input-group-label">Game Mode</span>
                    <select id="setup-mode-select" class="input-group-field" style="width: auto;">
                        <option value="auto">Auto (Flow)</option>
                        <option value="sandbox">Sandbox (Manual)</option>
                    </select>
                 </div>
            </div>
            <div id="setup-players-list">
                <!-- Dynamic Inputs -->
            </div>
            <div class="text-center" style="margin-top: 15px;">
                <button id="btn-confirm-setup" class="btn btn--success" data-i18n="game.setup.start">Start Game</button>
                <button id="btn-cancel-setup" class="btn btn--secondary" data-i18n="common.cancel">Cancel</button>
            </div>
        </div>

            </div> <!-- End of game-layout-main -->

            <div class="game-layout-sidebar">
                <div class="game-panel game-log-panel">
                    <div id="game-timing-badge" class="timing-badge"></div>
                    <div id="game-breadcrumbs" class="breadcrumbs"></div>
                </div>
            </div>
        </div> <!-- End of game-top-section -->
        
        <!-- Bottom Section: Main Perspective -->
        <div class="game-bottom-section">
            <!-- Independent Control Panel -->
            <div class="game-panel game-action-panel">
                <div id="game-controls">
                    <button class="btn btn--primary" id="btn-show-setup" data-i18n="game.setup">Game Setup</button>
                    <button class="btn btn--primary hidden" id="btn-start-game" data-i18n="game.start">Start Game</button>
                    <button class="btn btn--secondary hidden" id="btn-pause-game">Pause</button>
                    

                    <button class="btn btn--success hidden" id="btn-play-card" data-i18n="game.playCard">Play Card</button>
                    <button class="btn btn--danger hidden" id="btn-end-turn" data-i18n="game.endTurn">End Turn</button>
                </div>
            </div>

            <div class="game-main-area hidden" id="game-main-area">
                <div class="main-perspective-container">
                <div class="current-character-panel" style="position: relative;">
                    <div class="player-hand" style="position: relative;">
                        <div id="header-hand-area" class="area-watermark">Hand Cards</div>
                        <div id="hand-cards-container" class="cards-container" data-area-name="hand">
                            <!-- Cards will be rendered here -->
                        </div>
                    </div>

                    <div class="character-info">
                        <div class="char-avatar">
                            <img id="char-img" src="" alt="Character Avatar">
                        </div>
                        <div class="char-details">
                            <div class="name-row">
                                <h3 id="char-name">Character Name</h3>
                            </div>
                            <div class="char-stats">
                                <span class="stat-hp" id="char-hp-display">4/4</span>
                                <div class="stats-btn-group">
                                    <button class="judge-detail-btn main-judge-btn">判</button>
                                    <button class="equip-detail-btn main-equip-btn">備</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Role List moved to Top Table Panel -->
            </div>
        </div>
        </div> <!-- End of game-bottom-section -->
    </div>
</div>
