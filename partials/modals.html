<!-- 加载动画遮罩 -->
<div id="loading-overlay">
  <div style="display: flex; flex-direction: column; align-items: center;">
    <div class="loading-title" id="loading-title"></div>
    <div class="loading-bar-container">
      <div class="loading-bar"></div>
    </div>
  </div>
</div>

<!-- 弹窗背景遮罩 -->
<div id="modal-backdrop" class="modal-backdrop"></div>

<!-- 侧边栏菜单背景遮罩 -->
<div id="sidebar-backdrop" class="modal-backdrop"></div>

<!-- 侧边栏菜单（主菜单） -->
<div id="sidebar-menu" class="panel">
  <li style="display:flex; align-items:center; gap:10px;">
    <img id="sidebar-avatar-preview" src="" alt="avatar" style="width:32px; height:32px; border-radius:50%; object-fit:cover; border:1px solid #e2e8f0; display:none;" />
    <button id="open-account-menu-button" class="sidebar-menu_button" style="flex:1;" data-i18n="sidebar.account">账号</button>
  </li>
  <li>
    <button id="approve-request-button" class="sidebar-menu_button" data-i18n="sidebar.approvals">审核</button>
  </li>
  <li>
    <button id="theme-toggle-button" class="sidebar-menu_button" data-i18n="theme.toggle.toDark">切换为深色</button>
  </li>
  <li>
    <button id="lang-toggle-button" class="sidebar-menu_button">语言：中文</button>
  </li>
  <li>
    <button id="logout-button" class="sidebar-menu_button" data-i18n="sidebar.logout">退出</button>
  </li>
  
</div>

<!-- 账号菜单（与侧边栏同样式） -->
<div id="account-menu" class="panel">
  <li>
    <button id="account-menu-back" class="sidebar-menu_button" data-i18n="account.menu.back">返回</button>
  </li>
  <li>
    <button id="account-info-button" class="sidebar-menu_button" data-i18n="account.menu.info">名片</button>
  </li>
  <li>
    <button id="update-account-button" class="sidebar-menu_button" data-i18n="account.menu.password">密码</button>
  </li>
  <li>
    <button id="upload-avatar-button" class="sidebar-menu_button" data-i18n="account.menu.avatar">头像</button>
    <input type="file" id="upload-avatar-input" accept="image/*" style="display:none" />
  </li>
</div>

<div id="update-account-modal" class="modal update-modal">
  <div class="modal-header">
    <h2 data-i18n="modal.password.title">密码</h2>
  </div>
  <form id="updateForm" class="modal-form">
    <!-- 旧密码用于验证当前身份，autocomplete 使用 current-password -->
    <input type="password" id="oldPassword" name="oldPassword" data-i18n-attr="placeholder" data-i18n-placeholder="modal.password.old" placeholder="旧密码" required autocomplete="current-password">
    <!-- 新密码与确认新密码，autocomplete 使用 new-password -->
    <input type="password" id="newPassword" name="newPassword" data-i18n-attr="placeholder" data-i18n-placeholder="modal.password.new" placeholder="新密码" required autocomplete="new-password">
    <input type="password" id="confirmPassword" name="confirmPassword" data-i18n-attr="placeholder" data-i18n-placeholder="modal.password.confirm" placeholder="确认新密码" required autocomplete="new-password">
    <button type="submit" class="btn btn--primary btn--block" data-i18n="modal.password.update">更新</button>
  </form>
  <div id="responseMessage" class="modal-message"></div>
</div>

<div id="approve-user-modal" class="modal approve-modal">
  <div class="modal-header">
    <h2 data-i18n="modal.approvals.title">审核</h2>
  </div>
  <div id="pending-approvals-modal-content" style="padding: 12px; display:block;"></div>
</div>

<!--（权限管理改为面板，删除弹窗版本以避免 ID 冲突） -->

<!-- 头像管理弹窗：显示当前头像与上传按钮 -->
<div id="avatar-modal" class="modal update-modal">
  <div class="modal-header">
    <h2 data-i18n="modal.avatar.title">头像</h2>
  </div>
  <div class="modal-form">
  <img id="avatar-modal-preview" alt="avatar" style="width: 180px; height: 180px; border-radius: 50%; object-fit: cover; border: 1px solid #e2e8f0; background:#f8fafc; align-self:center; display:none;">
    <button id="avatar-modal-upload" class="btn btn--primary btn--block" data-i18n="modal.avatar.upload">上传头像</button>
    <div id="avatar-pending-wrap" style="margin-top:10px; display:none;">
      <div style="font-size:12px; color:#718096; margin-bottom:6px;" data-i18n="modal.avatar.pending">审核中</div>
      <img id="avatar-pending-preview" alt="pending" style="width: 96px; height: 96px; border-radius: 50%; object-fit: cover; border: 1px solid #e2e8f0; background:#f8fafc;">
    </div>
  </div>
  <div id="avatar-modal-message" class="modal-message"></div>
</div>

<!-- 头像裁剪弹窗 -->
<div id="avatar-crop-modal" class="modal" style="max-width: 720px;">
  <div class="modal-header"><h2 data-i18n="modal.crop.title">裁剪头像</h2></div>
  <div style="padding:12px;">
    <div style="width:100%; max-height:60vh; border:1px solid #e2e8f0; border-radius:8px; overflow:hidden; background:#f8fafc;">
      <img id="avatar-crop-image" alt="crop" style="max-width:100%; display:block;">
    </div>
    <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:12px;">
  <button id="avatar-crop-cancel" class="btn" data-i18n="modal.crop.cancel">取消</button>
  <button id="avatar-crop-confirm" class="btn btn--primary" data-i18n="modal.crop.confirm">裁剪并上传</button>
    </div>
    <div id="avatar-crop-message" class="modal-message" style="margin-top:8px;"></div>
  </div>
</div>

  <!-- 名片弹窗（新版样式） -->
  <div id="account-info-modal" class="modal update-modal account-info-modal">
    <div class="account-info__header">
      <img id="account-info-avatar" class="account-info__avatar" alt="avatar" />
      <div class="account-info__title">
        <div class="account-info__name" id="account-info-username">
          <span id="account-info-username-main"></span>
          <!-- 移除内联颜色/字号/外边距，统一由 CSS 控制（与容器 gap 保持一致） -->
          <span id="account-info-username-pending-inline" style="display:none;"></span>
          <button id="account-info-username-cancel-inline" class="btn btn--sm" style="display:none;" data-i18n="account.info.cancel">撤回</button>
        </div>
        <div class="account-info__role"><span class="badge" id="account-info-role"></span></div>
      </div>
    </div>
    <div class="account-info__body">
      <div class="info-row"><span class="info-label" data-i18n="account.info.username">用户名</span><span class="info-value" id="account-info-username-text"></span></div>
      <div class="info-row"><span class="info-label" data-i18n="account.info.userId">用户ID</span><span class="info-value" id="account-info-id"></span></div>
      <div class="account-info__intro">
        <textarea id="account-info-intro" class="intro-textarea" rows="4" maxlength="500" data-i18n-attr="placeholder" data-i18n-placeholder="account.info.placeholder.intro" placeholder="（暂无简介）"></textarea>
        <div id="account-info-intro-pending" class="info-hint" style="display:none;"></div>
      </div>
    </div>
    <div id="account-info-message" class="modal-message"></div>
  </div>
